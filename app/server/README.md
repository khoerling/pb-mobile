## api-v1

These routes are mostly autogenerated based on the Bookshelf models defined in **db**.
However, there are a few custom routes defined at the end for custom functionality that
goes beyond basic CRUD.

## db

**[Bookshelf](http://bookshelfjs.org/)** models for most tables in the PromoManager
schema are defined here.

### Exported Variables

* Bookshelf -- Bookshelf itself
* MySQL -- Bookshelf initialized with a MySQL connection
* util -- utility functions
* \_\_tables -- an array of table names we have Bookshelf models for
* \_\_relations -- an object where the keys are table names and the value is an object with methods that define relational information for Bookshelf.  These are mixed in to the model prototypes.
* \_\_methods -- another object where the keys are table names and the value is an object with custom methods.  These are also mixed into the model prototypes.

## home

This used to define the / route and any other route that is a traditional web page, but all that's
left in here is favicon.ico.

## logs

This defines the colorful access log we see in development.

### Exported Variables

* connection -- a connection to RabbitMQ
* x -- a namespace for Exchanges
    * x.config -- This is the config exchange that all the amqp-config-workers bind to.  Publish messages to this exchange with routing-keys that look like "config.#server-name".
* q -- a namespace for Queues
    * q.finish -- Whenever workers finish successfully, a messsage will be sent here.

## mw

This is where our express middleware functions are defined.

### Exported Variables

* react -- this middleware will either do a server-side render of a React powered page, or it will send the data required to render such a page as JSON.
* common-locals -- this adds some data to res.locals

## react-handlers

This is where handlers for React-powered pages are defined.  Their only
responsibility is to load res.locals with the data needed to render their
respective pages.

## repl

This is where we preload some modules into the REPL for convenience.
